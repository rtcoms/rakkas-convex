{
  "version": 3,
  "sources": ["../../../../../src/cli/lib/deployApi/componentDefinition.ts"],
  "sourcesContent": ["import { z } from \"zod\";\nimport { canonicalizedModulePath, componentDefinitionPath } from \"./paths.js\";\nimport { Identifier, Reference, identifier, reference } from \"./types.js\";\nimport { analyzedModule, udfConfig } from \"./modules.js\";\n\nexport const componentArgumentValidator = z.object({\n  type: z.literal(\"value\"),\n  // Validator serialized to JSON.\n  value: z.string(),\n});\n\nexport const componentDefinitionType = z.union([\n  z.object({ type: z.literal(\"app\") }),\n  z.object({\n    type: z.literal(\"childComponent\"),\n    name: identifier,\n    args: z.array(z.tuple([identifier, componentArgumentValidator])),\n  }),\n]);\n\nexport const componentArgument = z.object({\n  type: z.literal(\"value\"),\n  // Value serialized to JSON.\n  value: z.string(),\n});\n\nexport const componentInstantiation = z.object({\n  name: identifier,\n  path: componentDefinitionPath,\n  args: z.nullable(z.array(z.tuple([identifier, componentArgument]))),\n});\n\nexport type ComponentExports =\n  | { type: \"leaf\"; leaf: Reference }\n  | { type: \"branch\"; branch: [Identifier, ComponentExports][] };\n\nexport const componentExports: z.ZodType<ComponentExports> = z.lazy(() =>\n  z.union([\n    z.object({\n      type: z.literal(\"leaf\"),\n      leaf: reference,\n    }),\n    z.object({\n      type: z.literal(\"branch\"),\n      branch: z.array(z.tuple([identifier, componentExports])),\n    }),\n  ]),\n);\n\nexport const componentDefinitionMetadata = z.object({\n  path: componentDefinitionPath,\n  definitionType: componentDefinitionType,\n  childComponents: z.array(componentInstantiation),\n  httpMounts: z.record(z.string(), reference),\n  exports: z.object({\n    type: z.literal(\"branch\"),\n    branch: z.array(z.tuple([identifier, componentExports])),\n  }),\n});\n\nexport const evaluatedComponentDefinition = z.object({\n  definition: componentDefinitionMetadata,\n  schema: z.any(),\n  functions: z.record(canonicalizedModulePath, analyzedModule),\n  udfConfig,\n});\nexport type EvaluatedComponentDefinition = z.infer<\n  typeof evaluatedComponentDefinition\n>;\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAAkB;AAClB,mBAAiE;AACjE,mBAA6D;AAC7D,qBAA0C;AAEnC,MAAM,6BAA6B,aAAE,OAAO;AAAA,EACjD,MAAM,aAAE,QAAQ,OAAO;AAAA;AAAA,EAEvB,OAAO,aAAE,OAAO;AAClB,CAAC;AAEM,MAAM,0BAA0B,aAAE,MAAM;AAAA,EAC7C,aAAE,OAAO,EAAE,MAAM,aAAE,QAAQ,KAAK,EAAE,CAAC;AAAA,EACnC,aAAE,OAAO;AAAA,IACP,MAAM,aAAE,QAAQ,gBAAgB;AAAA,IAChC,MAAM;AAAA,IACN,MAAM,aAAE,MAAM,aAAE,MAAM,CAAC,yBAAY,0BAA0B,CAAC,CAAC;AAAA,EACjE,CAAC;AACH,CAAC;AAEM,MAAM,oBAAoB,aAAE,OAAO;AAAA,EACxC,MAAM,aAAE,QAAQ,OAAO;AAAA;AAAA,EAEvB,OAAO,aAAE,OAAO;AAClB,CAAC;AAEM,MAAM,yBAAyB,aAAE,OAAO;AAAA,EAC7C,MAAM;AAAA,EACN,MAAM;AAAA,EACN,MAAM,aAAE,SAAS,aAAE,MAAM,aAAE,MAAM,CAAC,yBAAY,iBAAiB,CAAC,CAAC,CAAC;AACpE,CAAC;AAMM,MAAM,mBAAgD,aAAE;AAAA,EAAK,MAClE,aAAE,MAAM;AAAA,IACN,aAAE,OAAO;AAAA,MACP,MAAM,aAAE,QAAQ,MAAM;AAAA,MACtB,MAAM;AAAA,IACR,CAAC;AAAA,IACD,aAAE,OAAO;AAAA,MACP,MAAM,aAAE,QAAQ,QAAQ;AAAA,MACxB,QAAQ,aAAE,MAAM,aAAE,MAAM,CAAC,yBAAY,gBAAgB,CAAC,CAAC;AAAA,IACzD,CAAC;AAAA,EACH,CAAC;AACH;AAEO,MAAM,8BAA8B,aAAE,OAAO;AAAA,EAClD,MAAM;AAAA,EACN,gBAAgB;AAAA,EAChB,iBAAiB,aAAE,MAAM,sBAAsB;AAAA,EAC/C,YAAY,aAAE,OAAO,aAAE,OAAO,GAAG,sBAAS;AAAA,EAC1C,SAAS,aAAE,OAAO;AAAA,IAChB,MAAM,aAAE,QAAQ,QAAQ;AAAA,IACxB,QAAQ,aAAE,MAAM,aAAE,MAAM,CAAC,yBAAY,gBAAgB,CAAC,CAAC;AAAA,EACzD,CAAC;AACH,CAAC;AAEM,MAAM,+BAA+B,aAAE,OAAO;AAAA,EACnD,YAAY;AAAA,EACZ,QAAQ,aAAE,IAAI;AAAA,EACd,WAAW,aAAE,OAAO,sCAAyB,6BAAc;AAAA,EAC3D;AACF,CAAC;",
  "names": []
}
