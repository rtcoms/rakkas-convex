{
  "version": 3,
  "sources": ["../../../../../src/cli/lib/deployApi/componentDefinition.ts"],
  "sourcesContent": ["import { z } from \"zod\";\nimport { canonicalizedModulePath, componentDefinitionPath } from \"./paths.js\";\nimport { Identifier, Reference, identifier, reference } from \"./types.js\";\nimport { analyzedModule, udfConfig } from \"./modules.js\";\n\nexport const componentArgumentValidator = z.object({\n  type: z.literal(\"value\"),\n  // Validator serialized to JSON.\n  value: z.string(),\n});\n\nexport const componentDefinitionType = z.union([\n  z.object({ type: z.literal(\"app\") }),\n  z.object({\n    type: z.literal(\"childComponent\"),\n    name: identifier,\n    args: z.array(z.tuple([identifier, componentArgumentValidator])),\n  }),\n]);\n\nexport const componentArgument = z.object({\n  type: z.literal(\"value\"),\n  // Value serialized to JSON.\n  value: z.string(),\n});\n\nexport const componentInstantiation = z.object({\n  name: identifier,\n  path: componentDefinitionPath,\n  args: z.nullable(z.array(z.tuple([identifier, componentArgument]))),\n});\n\nexport type ComponentExports =\n  | { type: \"leaf\"; leaf: Reference }\n  | { type: \"branch\"; branch: [Identifier, ComponentExports][] };\n\nexport const componentExports: z.ZodType<ComponentExports> = z.lazy(() =>\n  z.union([\n    z.object({\n      type: z.literal(\"leaf\"),\n      leaf: reference,\n    }),\n    z.object({\n      type: z.literal(\"branch\"),\n      branch: z.array(z.tuple([identifier, componentExports])),\n    }),\n  ]),\n);\n\nexport const componentDefinitionMetadata = z.object({\n  path: componentDefinitionPath,\n  definitionType: componentDefinitionType,\n  childComponents: z.array(componentInstantiation),\n  httpMounts: z.record(z.string(), reference),\n  exports: z.object({\n    type: z.literal(\"branch\"),\n    branch: z.array(z.tuple([identifier, componentExports])),\n  }),\n});\n\nexport const evaluatedComponentDefinition = z.object({\n  definition: componentDefinitionMetadata,\n  schema: z.any(),\n  functions: z.record(canonicalizedModulePath, analyzedModule),\n  udfConfig,\n});\nexport type EvaluatedComponentDefinition = z.infer<\n  typeof evaluatedComponentDefinition\n>;\n"],
  "mappings": ";AAAA,SAAS,SAAS;AAClB,SAAS,yBAAyB,+BAA+B;AACjE,SAAgC,YAAY,iBAAiB;AAC7D,SAAS,gBAAgB,iBAAiB;AAEnC,aAAM,6BAA6B,EAAE,OAAO;AAAA,EACjD,MAAM,EAAE,QAAQ,OAAO;AAAA;AAAA,EAEvB,OAAO,EAAE,OAAO;AAClB,CAAC;AAEM,aAAM,0BAA0B,EAAE,MAAM;AAAA,EAC7C,EAAE,OAAO,EAAE,MAAM,EAAE,QAAQ,KAAK,EAAE,CAAC;AAAA,EACnC,EAAE,OAAO;AAAA,IACP,MAAM,EAAE,QAAQ,gBAAgB;AAAA,IAChC,MAAM;AAAA,IACN,MAAM,EAAE,MAAM,EAAE,MAAM,CAAC,YAAY,0BAA0B,CAAC,CAAC;AAAA,EACjE,CAAC;AACH,CAAC;AAEM,aAAM,oBAAoB,EAAE,OAAO;AAAA,EACxC,MAAM,EAAE,QAAQ,OAAO;AAAA;AAAA,EAEvB,OAAO,EAAE,OAAO;AAClB,CAAC;AAEM,aAAM,yBAAyB,EAAE,OAAO;AAAA,EAC7C,MAAM;AAAA,EACN,MAAM;AAAA,EACN,MAAM,EAAE,SAAS,EAAE,MAAM,EAAE,MAAM,CAAC,YAAY,iBAAiB,CAAC,CAAC,CAAC;AACpE,CAAC;AAMM,aAAM,mBAAgD,EAAE;AAAA,EAAK,MAClE,EAAE,MAAM;AAAA,IACN,EAAE,OAAO;AAAA,MACP,MAAM,EAAE,QAAQ,MAAM;AAAA,MACtB,MAAM;AAAA,IACR,CAAC;AAAA,IACD,EAAE,OAAO;AAAA,MACP,MAAM,EAAE,QAAQ,QAAQ;AAAA,MACxB,QAAQ,EAAE,MAAM,EAAE,MAAM,CAAC,YAAY,gBAAgB,CAAC,CAAC;AAAA,IACzD,CAAC;AAAA,EACH,CAAC;AACH;AAEO,aAAM,8BAA8B,EAAE,OAAO;AAAA,EAClD,MAAM;AAAA,EACN,gBAAgB;AAAA,EAChB,iBAAiB,EAAE,MAAM,sBAAsB;AAAA,EAC/C,YAAY,EAAE,OAAO,EAAE,OAAO,GAAG,SAAS;AAAA,EAC1C,SAAS,EAAE,OAAO;AAAA,IAChB,MAAM,EAAE,QAAQ,QAAQ;AAAA,IACxB,QAAQ,EAAE,MAAM,EAAE,MAAM,CAAC,YAAY,gBAAgB,CAAC,CAAC;AAAA,EACzD,CAAC;AACH,CAAC;AAEM,aAAM,+BAA+B,EAAE,OAAO;AAAA,EACnD,YAAY;AAAA,EACZ,QAAQ,EAAE,IAAI;AAAA,EACd,WAAW,EAAE,OAAO,yBAAyB,cAAc;AAAA,EAC3D;AACF,CAAC;",
  "names": []
}
